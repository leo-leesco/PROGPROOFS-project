module Filter
	use list.List
	use list.Length
	use list.Mem

	let rec function filter (pred:'a -> bool) (l: list 'a) : (filtered : list 'a)
		ensures { forall x. mem x filtered -> pred x }
		ensures { forall x. mem x filtered -> mem x l }
		variant { length l }
	=
		match l with
		| Cons head tail ->
			let filtered = filter pred tail in
			assert { forall x. mem x filtered -> mem x l };
			if pred head then Cons head filtered else filtered
		| Nil -> Nil
		end
end
